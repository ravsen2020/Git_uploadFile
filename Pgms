this code is written for new logic
